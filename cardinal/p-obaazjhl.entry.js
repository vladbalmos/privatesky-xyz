import{r as t,h as e,g as s}from"./p-bd5842d7.js";import{C as r}from"./p-92afb37f.js";import{T as i}from"./p-fd654465.js";import{s as n,c as o}from"./p-40b98907.js";var c=function(t,e,s,r){var i,n=arguments.length,o=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,r);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(o=(n<3?i(o):n>3?i(e,s,o):i(e,s))||o);return n>3&&o&&Object.defineProperty(e,s,o),o};const l=class{constructor(e){t(this,e),this.activeChapter=null,this.chapters=[],this.title="",this.componentFullyLoaded=!1}receiveChapters(t){if(t.stopImmediatePropagation(),!t.detail)return;const e=Object.assign({},t.detail),s=this.chapters.findIndex(t=>e.guid===t.guid),r=[...this.chapters];if(-1===s)return r.push(Object.assign({},e)),void(this.chapters=JSON.parse(JSON.stringify(r)));r[s]=Object.assign({},e),this.chapters=JSON.parse(JSON.stringify(r))}_checkForChapterScrolling(){if(-1===window.location.href.indexOf("chapter="))return;const t=window.location.href.split("chapter=")[1];setTimeout(()=>{n(t,this.element)},50)}_sendTableOfContentChapters(){o("psk-send-toc",{bubbles:!0,composed:!0,cancelable:!0,detail:{chapters:this.chapters,active:this.activeChapter}},!0)}componentDidLoad(){this.componentFullyLoaded=!0,this._checkForChapterScrolling()}render(){return document.addEventListener("pageScroll",this.handleScrollEvent.bind(this),!0),this._sendTableOfContentChapters(),e("div",null,e("nav",null,e("h3",null,this.title)),e("div",{class:"page-content container"},this.componentFullyLoaded?e("slot",null):e("psk-ui-loader",{shouldBeRendered:!0})))}handleScrollEvent(t){t.preventDefault(),t.stopImmediatePropagation();const e=t.parentEventData&&t.parentEventData;if(!e)return;this.activeChapter=null;let s=null,r=0,i=Array.from(this.element.querySelectorAll("psk-chapter"));i.forEach(t=>{if(null!==s||null!==this.activeChapter)return;const i=t.getAttribute("guid");if(!i)return;const n=t.getElementsByClassName("card psk-card")&&t.getElementsByClassName("card psk-card")[0];let o=0;o=r>=n.offsetTop?r+n.offsetTop:n.offsetTop;const c=e.scrollTop;c>=r&&c<=o&&(this.activeChapter=s=i),r=o}),i.length>0&&(this.activeChapter=s||i[0].getAttribute("guid"))}get element(){return s(this)}};c([r()],l.prototype,"activeChapter",void 0),c([i({description:"This property will be used as the title for the page.",isMandatory:!1,propertyType:"string"})],l.prototype,"title",void 0),c([i({description:"This property is the name of the table of content.",isMandatory:!1,propertyType:"string"})],l.prototype,"tocTitle",void 0);export{l as psk_page};